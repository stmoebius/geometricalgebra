"""Testing the Cayley table


The reference was created via

    import numpy as np
    from clifford.tools import g3c
    np.set_printoptions(threshold=np.inf, linewidth=500)

    generator = g3c.layout.imt.todense()
    index_array = np.expand_dims(np.argmax(abs(generator), axis=1), 1) + 1
    index_array *= np.take_along_axis(generator, index_array - 1, 1)

    reconstruction = np.zeros((32, 32, 32), dtype=np.int8)
    np.put_along_axis(reconstruction, abs(index_array) - 1, np.sign(index_array), 1)
    (reconstruction == g3c.layout.imt.todense()).all()
    assert (reconstruction == generator).all()
    index_array
"""
import numpy as np
import pytest

from geometricalgebra.cayley import get_cayley_table

# note counting starts at 1 and negative value indicate a negative basis vector
TABLE = dict(
    geometric=np.array([
        [[  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,  31,  32]],
        [[  2,   1,   7,   8,   9,  10,   3,   4,   5,   6,  17,  18,  19,  20,  21,  22,  11,  12,  13,  14,  15,  16,  27,  28,  29,  30,  23,  24,  25,  26,  32,  31]],
        [[  3,  -7,   1,  11,  12,  13,  -2, -17, -18, -19,   4,   5,   6,  23,  24,  25,  -8,  -9, -10, -27, -28, -29,  14,  15,  16,  31, -20, -21, -22, -32,  26, -30]],
        [[  4,  -8, -11,   1,  14,  15,  17,  -2, -20, -21,  -3, -23, -24,   5,   6,  26,   7,  27,  28,  -9, -10, -30, -12, -13, -31,  16,  18,  19,  32, -22, -25,  29]],
        [[  5,  -9, -12, -14,   1,  16,  18,  20,  -2, -22,  23,  -3, -25,  -4, -26,   6, -27,   7,  29,   8,  30, -10,  11,  31, -13, -15, -17, -32,  19,  21,  24, -28]],
        [[  6, -10, -13, -15, -16,  -1,  19,  21,  22,   2,  24,  25,   3,  26,   4,   5, -28, -29,  -7, -30,  -8,  -9, -31, -11, -12, -14,  32,  17,  18,  20,  23, -27]],
        [[  7,  -3,   2,  17,  18,  19,  -1, -11, -12, -13,   8,   9,  10,  27,  28,  29,  -4,  -5,  -6, -23, -24, -25,  20,  21,  22,  32, -14, -15, -16, -31,  30, -26]],
        [[  8,  -4, -17,   2,  20,  21,  11,  -1, -14, -15,  -7, -27, -28,   9,  10,  30,   3,  23,  24,  -5,  -6, -26, -18, -19, -32,  22,  12,  13,  31, -16, -29,  25]],
        [[  9,  -5, -18, -20,   2,  22,  12,  14,  -1, -16,  27,  -7, -29,  -8, -30,  10, -23,   3,  25,   4,  26,  -6,  17,  32, -19, -21, -11, -31,  13,  15,  28, -24]],
        [[ 10,  -6, -19, -21, -22,  -2,  13,  15,  16,   1,  28,  29,   7,  30,   8,   9, -24, -25,  -3, -26,  -4,  -5, -32, -17, -18, -20,  31,  11,  12,  14,  27, -23]],
        [[ 11,  17,  -4,   3,  23,  24,  -8,   7,  27,  28,  -1, -14, -15,  12,  13,  31,  -2, -20, -21,  18,  19,  32,  -5,  -6, -26,  25,  -9, -10, -30,  29, -16, -22]],
        [[ 12,  18,  -5, -23,   3,  25,  -9, -27,   7,  29,  14,  -1, -16, -11, -31,  13,  20,  -2, -22, -17, -32,  19,   4,  26,  -6, -24,   8,  30, -10, -28,  15,  21]],
        [[ 13,  19,  -6, -24, -25,  -3, -10, -28, -29,  -7,  15,  16,   1,  31,  11,  12,  21,  22,   2,  32,  17,  18, -26,  -4,  -5, -23, -30,  -8,  -9, -27,  14,  20]],
        [[ 14,  20,  23,  -5,   4,  26,  27,  -9,   8,  30, -12,  11,  31,  -1, -16,  15, -18,  17,  32,  -2, -22,  21,  -3, -25,  24,  -6,  -7, -29,  28, -10, -13, -19]],
        [[ 15,  21,  24,  -6, -26,  -4,  28, -10, -30,  -8, -13, -31, -11,  16,   1,  14, -19, -32, -17,  22,   2,  20,  25,   3,  23,  -5,  29,   7,  27,  -9, -12, -18]],
        [[ 16,  22,  25,  26,  -6,  -5,  29,  30, -10,  -9,  31, -13, -12, -15, -14,   1,  32, -19, -18, -21, -20,   2, -24, -23,   3,   4, -28, -27,   7,   8,  11,  17]],
        [[ 17,  11,  -8,   7,  27,  28,  -4,   3,  23,  24,  -2, -20, -21,  18,  19,  32,  -1, -14, -15,  12,  13,  31,  -9, -10, -30,  29,  -5,  -6, -26,  25, -22, -16]],
        [[ 18,  12,  -9, -27,   7,  29,  -5, -23,   3,  25,  20,  -2, -22, -17, -32,  19,  14,  -1, -16, -11, -31,  13,   8,  30, -10, -28,   4,  26,  -6, -24,  21,  15]],
        [[ 19,  13, -10, -28, -29,  -7,  -6, -24, -25,  -3,  21,  22,   2,  32,  17,  18,  15,  16,   1,  31,  11,  12, -30,  -8,  -9, -27, -26,  -4,  -5, -23,  20,  14]],
        [[ 20,  14,  27,  -9,   8,  30,  23,  -5,   4,  26, -18,  17,  32,  -2, -22,  21, -12,  11,  31,  -1, -16,  15,  -7, -29,  28, -10,  -3, -25,  24,  -6, -19, -13]],
        [[ 21,  15,  28, -10, -30,  -8,  24,  -6, -26,  -4, -19, -32, -17,  22,   2,  20, -13, -31, -11,  16,   1,  14,  29,   7,  27,  -9,  25,   3,  23,  -5, -18, -12]],
        [[ 22,  16,  29,  30, -10,  -9,  25,  26,  -6,  -5,  32, -19, -18, -21, -20,   2,  31, -13, -12, -15, -14,   1, -28, -27,   7,   8, -24, -23,   3,   4,  17,  11]],
        [[ 23, -27,  14, -12,  11,  31, -20,  18, -17, -32,  -5,   4,  26,  -3, -25,  24,   9,  -8, -30,   7,  29, -28,  -1, -16,  15, -13,   2,  22, -21,  19,  -6,  10]],
        [[ 24, -28,  15, -13, -31, -11, -21,  19,  32,  17,  -6, -26,  -4,  25,   3,  23,  10,  30,   8, -29,  -7, -27,  16,   1,  14, -12, -22,  -2, -20,  18,  -5,   9]],
        [[ 25, -29,  16,  31, -13, -12, -22, -32,  19,  18,  26,  -6,  -5, -24, -23,   3, -30,  10,   9,  28,  27,  -7, -15, -14,   1,  11,  21,  20,  -2, -17,   4,  -8]],
        [[ 26, -30, -31,  16, -15, -14,  32, -22,  21,  20, -25,  24,  23,  -6,  -5,   4,  29, -28, -27,  10,   9,  -8,  13,  12, -11,   1, -19, -18,  17,  -2,  -3,   7]],
        [[ 27, -23,  20, -18,  17,  32, -14,  12, -11, -31,  -9,   8,  30,  -7, -29,  28,   5,  -4, -26,   3,  25, -24,  -2, -22,  21, -19,   1,  16, -15,  13, -10,   6]],
        [[ 28, -24,  21, -19, -32, -17, -15,  13,  31,  11, -10, -30,  -8,  29,   7,  27,   6,  26,   4, -25,  -3, -23,  22,   2,  20, -18, -16,  -1, -14,  12,  -9,   5]],
        [[ 29, -25,  22,  32, -19, -18, -16, -31,  13,  12,  30, -10,  -9, -28, -27,   7, -26,   6,   5,  24,  23,  -3, -21, -20,   2,  17,  15,  14,  -1, -11,   8,  -4]],
        [[ 30, -26, -32,  22, -21, -20,  31, -16,  15,  14, -29,  28,  27, -10,  -9,   8,  25, -24, -23,   6,   5,  -4,  19,  18, -17,   2, -13, -12,  11,  -1,  -7,   3]],
        [[ 31,  32, -26,  25, -24, -23, -30,  29, -28, -27, -16,  15,  14, -13, -12,  11, -22,  21,  20, -19, -18,  17,   6,   5,  -4,   3,  10,   9,  -8,   7,  -1,  -2]],
        [[ 32,  31, -30,  29, -28, -27, -26,  25, -24, -23, -22,  21,  20, -19, -18,  17, -16,  15,  14, -13, -12,  11,  10,   9,  -8,   7,   6,   5,  -4,   3,  -2,  -1]]
    ]),
    outer=np.array([
        [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]],
        [[2, 0, 7, 8, 9, 10, 0, 0, 0, 0, 17, 18, 19, 20, 21, 22, 0, 0, 0, 0, 0, 0, 27, 28, 29, 30, 0, 0, 0, 0, 32, 0]],
        [[3, -7, 0, 11, 12, 13, 0, -17, -18, -19, 0, 0, 0, 23, 24, 25, 0, 0, 0, -27, -28, -29, 0, 0, 0, 31, 0, 0, 0, -32, 0, 0]],
        [[4, -8, -11, 0, 14, 15, 17, 0, -20, -21, 0, -23, -24, 0, 0, 26, 0, 27, 28, 0, 0, -30, 0, 0, -31, 0, 0, 0, 32, 0, 0, 0]],
        [[5, -9, -12, -14, 0, 16, 18, 20, 0, -22, 23, 0, -25, 0, -26, 0, -27, 0, 29, 0, 30, 0, 0, 31, 0, 0, 0, -32, 0, 0, 0, 0]],
        [[6, -10, -13, -15, -16, 0, 19, 21, 22, 0, 24, 25, 0, 26, 0, 0, -28, -29, 0, -30, 0, 0, -31, 0, 0, 0, 32, 0, 0, 0, 0, 0]],
        [[7, 0, 0, 17, 18, 19, 0, 0, 0, 0, 0, 0, 0, 27, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0]],
        [[8, 0, -17, 0, 20, 21, 0, 0, 0, 0, 0, -27, -28, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0]],
        [[9, 0, -18, -20, 0, 22, 0, 0, 0, 0, 27, 0, -29, 0, -30, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[10, 0, -19, -21, -22, 0, 0, 0, 0, 0, 28, 29, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[11, 17, 0, 0, 23, 24, 0, 0, 27, 28, 0, 0, 0, 0, 0, 31, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[12, 18, 0, -23, 0, 25, 0, -27, 0, 29, 0, 0, 0, 0, -31, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[13, 19, 0, -24, -25, 0, 0, -28, -29, 0, 0, 0, 0, 31, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[14, 20, 23, 0, 0, 26, 27, 0, 0, 30, 0, 0, 31, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[15, 21, 24, 0, -26, 0, 28, 0, -30, 0, 0, -31, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[16, 22, 25, 26, 0, 0, 29, 30, 0, 0, 31, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[17, 0, 0, 0, 27, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[18, 0, 0, -27, 0, 29, 0, 0, 0, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[19, 0, 0, -28, -29, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[20, 0, 27, 0, 0, 30, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[21, 0, 28, 0, -30, 0, 0, 0, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[22, 0, 29, 30, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[23, -27, 0, 0, 0, 31, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[24, -28, 0, 0, -31, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[25, -29, 0, 31, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[26, -30, -31, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[27, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[28, 0, 0, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[29, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[30, 0, -32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[31, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
        [[32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
    ]),
    inner=np.array([
        [[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0]],
        [[  0,   1,   0,   0,   0,   0,   3,   4,   5,   6,   0,   0,   0,   0,   0,   0,  11,  12,  13,  14,  15,  16,   0,   0,   0,   0,  23,  24,  25,  26,   0,  31]],
        [[  0,   0,   1,   0,   0,   0,  -2,   0,   0,   0,   4,   5,   6,   0,   0,   0,  -8,  -9, -10,   0,   0,   0,  14,  15,  16,   0, -20, -21, -22,   0,  26, -30]],
        [[  0,   0,   0,   1,   0,   0,   0,  -2,   0,   0,  -3,   0,   0,   5,   6,   0,   7,   0,   0,  -9, -10,   0, -12, -13,   0,  16,  18,  19,   0, -22, -25,  29]],
        [[  0,   0,   0,   0,   1,   0,   0,   0,  -2,   0,   0,  -3,   0,  -4,   0,   6,   0,   7,   0,   8,   0, -10,  11,   0, -13, -15, -17,   0,  19,  21,  24, -28]],
        [[  0,   0,   0,   0,   0,  -1,   0,   0,   0,   2,   0,   0,   3,   0,   4,   5,   0,   0,  -7,   0,  -8,  -9,   0, -11, -12, -14,   0,  17,  18,  20,  23, -27]],
        [[  0,  -3,   2,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -4,  -5,  -6,   0,   0,   0,   0,   0,   0,   0, -14, -15, -16,   0,   0, -26]],
        [[  0,  -4,   0,   2,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   3,   0,   0,  -5,  -6,   0,   0,   0,   0,   0,  12,  13,   0, -16,   0,  25]],
        [[  0,  -5,   0,   0,   2,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   3,   0,   4,   0,  -6,   0,   0,   0,   0, -11,   0,  13,  15,   0, -24]],
        [[  0,  -6,   0,   0,   0,  -2,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,  -4,  -5,   0,   0,   0,   0,   0,  11,  12,  14,   0, -23]],
        [[  0,   0,  -4,   3,   0,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,  -2,   0,   0,   0,   0,   0,  -5,  -6,   0,   0,  -9, -10,   0,   0, -16, -22]],
        [[  0,   0,  -5,   0,   3,   0,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,  -2,   0,   0,   0,   0,   4,   0,  -6,   0,   8,   0, -10,   0,  15,  21]],
        [[  0,   0,  -6,   0,   0,  -3,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   2,   0,   0,   0,   0,  -4,  -5,   0,   0,  -8,  -9,   0,  14,  20]],
        [[  0,   0,   0,  -5,   4,   0,   0,   0,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,  -2,   0,   0,  -3,   0,   0,  -6,  -7,   0,   0, -10, -13, -19]],
        [[  0,   0,   0,  -6,   0,  -4,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   2,   0,   0,   3,   0,  -5,   0,   7,   0,  -9, -12, -18]],
        [[  0,   0,   0,   0,  -6,  -5,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   2,   0,   0,   3,   4,   0,   0,   7,   8,  11,  17]],
        [[  0,  11,  -8,   7,   0,   0,  -4,   3,   0,   0,  -2,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -5,  -6,   0,   0,   0, -16]],
        [[  0,  12,  -9,   0,   7,   0,  -5,   0,   3,   0,   0,  -2,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   4,   0,  -6,   0,   0,  15]],
        [[  0,  13, -10,   0,   0,  -7,  -6,   0,   0,  -3,   0,   0,   2,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,  -4,  -5,   0,   0,  14]],
        [[  0,  14,   0,  -9,   8,   0,   0,  -5,   4,   0,   0,   0,   0,  -2,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,  -3,   0,   0,  -6,   0, -13]],
        [[  0,  15,   0, -10,   0,  -8,   0,  -6,   0,  -4,   0,   0,   0,   0,   2,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   3,   0,  -5,   0, -12]],
        [[  0,  16,   0,   0, -10,  -9,   0,   0,  -6,  -5,   0,   0,   0,   0,   0,   2,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   3,   4,   0,  11]],
        [[  0,   0,  14, -12,  11,   0,   0,   0,   0,   0,  -5,   4,   0,  -3,   0,   0,   0,   0,   0,   0,   0,   0,  -1,   0,   0,   0,   2,   0,   0,   0,  -6,  10]],
        [[  0,   0,  15, -13,   0, -11,   0,   0,   0,   0,  -6,   0,  -4,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,  -2,   0,   0,  -5,   9]],
        [[  0,   0,  16,   0, -13, -12,   0,   0,   0,   0,   0,  -6,  -5,   0,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,  -2,   0,   4,  -8]],
        [[  0,   0,   0,  16, -15, -14,   0,   0,   0,   0,   0,   0,   0,  -6,  -5,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,  -2,  -3,   7]],
        [[  0, -23,  20, -18,  17,   0, -14,  12, -11,   0,  -9,   8,   0,  -7,   0,   0,   5,  -4,   0,   3,   0,   0,  -2,   0,   0,   0,   1,   0,   0,   0,   0,   6]],
        [[  0, -24,  21, -19,   0, -17, -15,  13,   0,  11, -10,   0,  -8,   0,   7,   0,   6,   0,   4,   0,  -3,   0,   0,   2,   0,   0,   0,  -1,   0,   0,   0,   5]],
        [[  0, -25,  22,   0, -19, -18, -16,   0,  13,  12,   0, -10,  -9,   0,   0,   7,   0,   6,   5,   0,   0,  -3,   0,   0,   2,   0,   0,   0,  -1,   0,   0,  -4]],
        [[  0, -26,   0,  22, -21, -20,   0, -16,  15,  14,   0,   0,   0, -10,  -9,   8,   0,   0,   0,   6,   5,  -4,   0,   0,   0,   2,   0,   0,   0,  -1,   0,   3]],
        [[  0,   0, -26,  25, -24, -23,   0,   0,   0,   0, -16,  15,  14, -13, -12,  11,   0,   0,   0,   0,   0,   0,   6,   5,  -4,   3,   0,   0,   0,   0,  -1,  -2]],
        [[  0,  31, -30,  29, -28, -27, -26,  25, -24, -23, -22,  21,  20, -19, -18,  17, -16,  15,  14, -13, -12,  11,  10,   9,  -8,   7,   6,   5,  -4,   3,  -2,  -1]]
    ])
)

@pytest.mark.parametrize("producttype", ["geometric"])
def test_cayley(producttype):
    """Test the generated Caylay table for the conformal geometric algebra"""
    reference = np.zeros((32, 32, 32), np.int8)
    np.put_along_axis(
        reference,
        abs(TABLE[producttype]) - 1,
        np.sign(TABLE[producttype]),
        1,
    )
    tmp = get_cayley_table([1, 1, 1, 1, -1])
    assert (tmp == reference).all()


def test_cga2d():
    """Test the correct dimensions of the 2d CGA"""
    a = get_cayley_table([1, 1, 1, -1])
    assert a.shape == (16, 16, 16)
